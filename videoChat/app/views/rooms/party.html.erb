<head>
  <meta charset="utf-8">
  <title><%= @room.name %></title>
</head>

<body>
  <script src='//static.opentok.com/v2/js/opentok.min.js'></script>
  <script>
    var apiKey = "45486522";
    var sessionId = <%= @room.sessionId %>;
    var token = <%= @tok_token %>;
    var session = OT.initSession(apiKey, sessionId);

    session.connect(token, function(err){
      if(err){
        alert("There is an error!");
      }
      else{
        session.publish();
      }
    });

    session.on("streamCreated", function(event){
      session.subscribe(event.stream);
    });

  </script>
  <br>
  <p><%= "ApiKey: " + @apiKey %>
  <br><%= "Room: " + @room.name %>
  <br><%= "SessionId: " + @room.sessionId %>
  <br><%= "Tok_token" + @tok_token %></p>
</body>
